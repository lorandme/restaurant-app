<Window x:Class="restaurant_app.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:restaurant_app.Views"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
<Window.Resources>
    <!-- Style for menu buttons -->
    <Style x:Key="MenuButtonStyle" TargetType="Button">
        <Setter Property="Margin" Value="5"/>
        <Setter Property="Padding" Value="10,5"/>
        <Setter Property="Background" Value="#FF4C8C4A"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="MinWidth" Value="100"/>
        <Setter Property="MinHeight" Value="30"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border Background="{TemplateBinding Background}" 
                                CornerRadius="5" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#FF6AAC68"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#FF3A6C39"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="#FFB5B5B5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for product items -->
    <Style x:Key="ProductCardStyle" TargetType="Border">
        <Setter Property="BorderBrush" Value="#FFDDDDDD"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="5"/>
        <Setter Property="Margin" Value="5"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="Effect">
            <Setter.Value>
                <DropShadowEffect BlurRadius="5" ShadowDepth="2" Opacity="0.2"/>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Boolean to Visibility Converter -->
    <BooleanToVisibilityConverter x:Key="BoolToVis"/>
</Window.Resources>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header with restaurant name and navigation -->
    <Border Grid.Row="0" Background="#FF4C8C4A" Padding="15" Height="80">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Restaurant Logo -->
            <TextBlock Grid.Column="0" Text="Restaurant App" 
                           FontSize="24" FontWeight="Bold" 
                           VerticalAlignment="Center"
                           Foreground="White"/>

            <!-- Main Navigation -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" 
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button Content="Meniu" Style="{StaticResource MenuButtonStyle}" 
                            IsEnabled="False" Margin="5,0" Width="120"/>
                <Button Content="Căutare" Style="{StaticResource MenuButtonStyle}" 
                            Margin="5,0" Width="120"/>
            </StackPanel>

            <!-- Login/Register Section -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" 
                            HorizontalAlignment="Right" VerticalAlignment="Center">
                <Button Content="Coș" Command="{Binding ViewCartCommand}" 
                            Style="{StaticResource MenuButtonStyle}"
                            Visibility="{Binding IsUserClient, Converter={StaticResource BoolToVis}}"/>
                <Button Content="Autentificare" Command="{Binding LoginCommand}" 
                            Style="{StaticResource MenuButtonStyle}"
                            Visibility="{Binding IsUserLoggedIn, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
                <Button Content="Înregistrare" Command="{Binding RegisterCommand}" 
                            Style="{StaticResource MenuButtonStyle}"
                            Visibility="{Binding IsUserLoggedIn, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
            </StackPanel>
        </Grid>
    </Border>

    <!-- Main Content Area -->
    <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Sidebar: Categories and Search -->
        <Border Grid.Column="0" Background="#FFF5F5F5" Padding="10">
            <StackPanel>
                <!-- Search Section -->
                <TextBlock Text="Căutare" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

                <TextBlock Text="După cuvânt cheie:" Margin="0,5"/>
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding SearchKeyword, UpdateSourceTrigger=PropertyChanged}" 
                                 Padding="5" Margin="0,0,5,0"/>
                    <Button Grid.Column="1" Content="Caută" Command="{Binding SearchByKeywordCommand}"
                                Style="{StaticResource MenuButtonStyle}"/>
                </Grid>

                <TextBlock Text="După alergen:" Margin="0,5"/>
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding SearchAllergen, UpdateSourceTrigger=PropertyChanged}" 
                                 Padding="5" Margin="0,0,5,0"/>
                    <Button Grid.Column="1" Content="Caută" Command="{Binding SearchByAllergenCommand}"
                                Style="{StaticResource MenuButtonStyle}"/>
                </Grid>

                <CheckBox Content="Exclude acest alergen" IsChecked="{Binding ExcludeAllergen}" Margin="0,0,0,20"/>

                <!-- Category List -->
                <TextBlock Text="Categorii" FontSize="18" FontWeight="Bold" Margin="0,10"/>
                <ListView ItemsSource="{Binding Categories}" Margin="0,5" 
                              BorderThickness="0" Background="Transparent">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}" Padding="5"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>
        </Border>

        <!-- Main Menu Display Area -->
        <Grid Grid.Column="1">
            <!-- Regular Menu View -->
            <ScrollViewer Visibility="{Binding IsSearchResultsVisible, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}">
                <StackPanel>
                    <TextBlock Text="Meniu Restaurant" FontSize="24" FontWeight="Bold" 
                                   Margin="20,15" HorizontalAlignment="Center"/>

                    <!-- Products Section -->
                    <TextBlock Text="Produse" FontSize="20" FontWeight="Bold" Margin="20,10"/>

                    <ItemsControl ItemsSource="{Binding Products}" Margin="15">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ProductCardStyle}" Width="200" Height="280">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="140"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Product Image Placeholder -->
                                        <Border Grid.Row="0" Background="#FFEAEAEA">
                                            <TextBlock Text="Imagine produs" 
                                                           HorizontalAlignment="Center" 
                                                           VerticalAlignment="Center"
                                                           Foreground="#FF888888"/>
                                        </Border>

                                        <!-- Product Availability -->
                                        <Border Grid.Row="0" 
                                                    Background="#FFFF5252" 
                                                    HorizontalAlignment="Right" 
                                                    VerticalAlignment="Top"
                                                    Margin="0,5,5,0"
                                                    Padding="5,2"
                                                    CornerRadius="3"
                                                    Visibility="{Binding IsAvailable, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}">
                                            <TextBlock Text="Indisponibil" 
                                                           Foreground="White"
                                                           FontSize="10"
                                                           FontWeight="Bold"/>
                                        </Border>

                                        <!-- Product Name -->
                                        <TextBlock Grid.Row="1" Text="{Binding ProductName}" 
                                                       FontWeight="Bold" Margin="10,5"
                                                       TextWrapping="Wrap"/>

                                        <!-- Product Category -->
                                        <TextBlock Grid.Row="2" Text="{Binding CategoryName}" 
                                                       Foreground="#FF666666" Margin="10,0,10,5"
                                                       FontSize="12"/>

                                        <!-- Product Details -->
                                        <StackPanel Grid.Row="3" Margin="10,0">
                                            <TextBlock>
                                                    <Run Text="{Binding PortionQuantity}"/>
                                                    <Run Text="{Binding PortionUnit}"/>
                                                    <Run Text=" / porție"/>
                                            </TextBlock>
                                            <TextBlock Text="{Binding Price, StringFormat={}{0:C}}" 
                                                           FontWeight="Bold" Foreground="#FF4C8C4A"/>
                                        </StackPanel>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Row="4" Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                                        Margin="0,0,5,5">
                                            <Button Content="Detalii" 
                                                        Command="{Binding DataContext.ViewProductDetailsCommand, 
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"
                                                        Margin="0,0,5,0"/>
                                            <Button Content="Adaugă" 
                                                        Command="{Binding DataContext.AddToCartCommand,
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"
                                                        IsEnabled="{Binding IsAvailable}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Menus Section -->
                    <TextBlock Text="Meniuri" FontSize="20" FontWeight="Bold" Margin="20,10"/>

                    <ItemsControl ItemsSource="{Binding Menus}" Margin="15">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ProductCardStyle}" Width="300" Height="200">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Menu Name -->
                                        <TextBlock Grid.Row="0" Text="{Binding MenuName}" 
                                                       FontWeight="Bold" Margin="10,5"
                                                       FontSize="16"/>

                                        <!-- Menu Category -->
                                        <TextBlock Grid.Row="1" Text="{Binding CategoryName}" 
                                                       Foreground="#FF666666" Margin="10,0,10,5"
                                                       FontSize="12"/>

                                        <!-- Menu Description -->
                                        <TextBlock Grid.Row="2" Text="{Binding Description}" 
                                                       TextWrapping="Wrap" Margin="10,5"/>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Row="3" Orientation="Horizontal" 
                                                        HorizontalAlignment="Right"
                                                        Margin="0,0,5,5">
                                            <Button Content="Detalii" 
                                                        Command="{Binding DataContext.ViewMenuDetailsCommand, 
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"
                                                        Margin="0,0,5,0"/>
                                            <Button Content="Adaugă" 
                                                        Command="{Binding DataContext.AddToCartCommand,
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>

            <!-- Search Results View -->
            <ScrollViewer Visibility="{Binding IsSearchResultsVisible, Converter={StaticResource BoolToVis}}">
                <StackPanel>
                    <Grid Margin="20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Rezultate căutare" 
                                       FontSize="24" FontWeight="Bold"/>
                        <Button Grid.Column="1" Content="Înapoi la meniu" 
                                    Click="BackToMenu_Click"
                                    Style="{StaticResource MenuButtonStyle}"/>
                    </Grid>

                    <ItemsControl ItemsSource="{Binding SearchResults}" Margin="15">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ProductCardStyle}" Width="200" Height="280">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="140"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Product Image Placeholder -->
                                        <Border Grid.Row="0" Background="#FFEAEAEA">
                                            <TextBlock Text="Imagine produs" 
                                                           HorizontalAlignment="Center" 
                                                           VerticalAlignment="Center"
                                                           Foreground="#FF888888"/>
                                        </Border>

                                        <!-- Product Availability -->
                                        <Border Grid.Row="0" 
                                                    Background="#FFFF5252" 
                                                    HorizontalAlignment="Right" 
                                                    VerticalAlignment="Top"
                                                    Margin="0,5,5,0"
                                                    Padding="5,2"
                                                    CornerRadius="3"
                                                    Visibility="{Binding IsAvailable, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}">
                                            <TextBlock Text="Indisponibil" 
                                                           Foreground="White"
                                                           FontSize="10"
                                                           FontWeight="Bold"/>
                                        </Border>

                                        <!-- Product Name -->
                                        <TextBlock Grid.Row="1" Text="{Binding ProductName}" 
                                                       FontWeight="Bold" Margin="10,5"
                                                       TextWrapping="Wrap"/>

                                        <!-- Product Category -->
                                        <TextBlock Grid.Row="2" Text="{Binding CategoryName}" 
                                                       Foreground="#FF666666" Margin="10,0,10,5"
                                                       FontSize="12"/>

                                        <!-- Product Details -->
                                        <StackPanel Grid.Row="3" Margin="10,0">
                                            <TextBlock>
                                                    <Run Text="{Binding PortionQuantity}"/>
                                                    <Run Text="{Binding PortionUnit}"/>
                                                    <Run Text=" / porție"/>
                                            </TextBlock>
                                            <TextBlock Text="{Binding Price, StringFormat={}{0:C}}" 
                                                           FontWeight="Bold" Foreground="#FF4C8C4A"/>
                                            <TextBlock Text="{Binding Allergens}" 
                                                           TextWrapping="Wrap" Foreground="#FF666666" 
                                                           FontSize="10" Margin="0,2,0,0"/>
                                        </StackPanel>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Row="4" Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                                        Margin="0,0,5,5">
                                            <Button Content="Detalii" 
                                                        Command="{Binding DataContext.ViewProductDetailsCommand, 
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"
                                                        Margin="0,0,5,0"/>
                                            <Button Content="Adaugă" 
                                                        Command="{Binding DataContext.AddToCartCommand,
                                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource MenuButtonStyle}"
                                                        IsEnabled="{Binding IsAvailable}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>

            <!-- Loading Overlay -->
            <Border Background="#80000000" Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="Se încarcă..." Foreground="White" FontSize="24" Margin="0,0,0,10"/>
                    <ProgressBar IsIndeterminate="True" Width="200" Height="10"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>

    <!-- Status Bar -->
    <Border Grid.Row="2" Background="#FFF5F5F5" Padding="10">
        <TextBlock Text="{Binding StatusMessage}" Foreground="#FF666666"/>
    </Border>

    <!-- Navigation Frame - Consider adding this if you need frame-based navigation -->
    <!-- <Frame x:Name="MainFrame" Grid.Row="1" NavigationUIVisibility="Hidden"/> -->
</Grid>
</Window>
